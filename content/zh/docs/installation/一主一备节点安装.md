# 一主一备节点安装<a name="ZH-CN_TOPIC_0000001091808934"></a>

## 前提条件：<a name="section9955194683210"></a>

-   已完成用户组和普通用户的创建。
-   所有服务器操作系统和网络均正常运行。
-   普通用户必须有数据库安装路径的读、写和执行操作权限，并且安装路径必须为空。
-   普通用户对下载的openGauss压缩包有执行权限。
-   安装前请检查指定的openGauss端口矩阵中所有端口是否被占用，如果被占用请更改端口或者停止当前使用端口进程。端口号请参考下方步骤三参数说明。

## 操作步骤<a name="section4241123615573"></a>

1.  登录到openGauss的主机，并切换到omm用户。

    ```
    su - omm
    ```

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >-   omm指的是安装、运行和维护openGauss的普通用户。
    >-   openGauss 在海思高版本芯片上编译的版本不能在海思低版本芯片的服务器上运行，比如Hi1620编译的版本不能在Hi1616环境上运行。

2.  解压openGauss压缩包到安装目录。

    ```
    tar -jxf openGauss-x.x.x-openEuler-64bit.tar.bz2 -C /opt/software/openGauss
    ```

3.  进入解压后openGauss目录下的simpleInstall。

    ```
    cd /opt/software/openGauss/simpleInstall
    ```

4.  执行install.sh脚本安装openGauss。

    ```
    sh install.sh  -w xxxx -p 5432 --multinode
    ```

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >-   -w：安装完成后登陆数据库密码。
    >-   -p：指定的openGauss主端口号, 默认5432。备端口号会使用主端口号+200，默认5632。
    >-   --multinode: 用来区分是单节点还是一主一备安装。
    >-   -h|--help 打印使用说明。

5.  安装执行完成后，使用ps和gs\_ctl查看进程是否正常。

    ```
    ps ux | grep gaussdb
    gs_ctl query -D /opt/software/openGauss/data/master
    ```

    执行ps命令，显示类似如下信息：

    ```
    omm  4879 11.8 1.1 2082452 373832 pts/0  Sl   14:26   8:29 /opt/software/openGauss/bin/gaussdb -D /opt/software/openGauss/data/master -M primary
    
    omm  5083  1.1  0.9 1819988 327200 pts/0  Sl   14:26   0:49 /opt/software/openGauss/bin/gaussdb -D /opt/software/openGauss/data/slave -M standby
    
    omm      20377  0.0  0.0 119880  1216 pts/0    S+   15:37   0:00 grep --color=auto gaussdb
    ```

    执行gs\_ctl命令，显示类似如下信息：

    ```
    gs_ctl query ,datadir is /opt/software/openGauss/data/master
    HA state:
        local_role                     : Primary
        static_connections             : 1
        db_state                       : Normal
        detail_information             : Normal
    
    Senders info:
        sender_pid                     : 5165
        local_role                     : Primary
        peer_role                      : Standby
        peer_state                     : Normal
        state                          : Streaming
        sender_sent_location           : 0/4005148
        sender_write_location          : 0/4005148
        sender_flush_location          : 0/4005148
        sender_replay_location         : 0/4005148
        receiver_received_location     : 0/4005148
        receiver_write_location        : 0/4005148
        receiver_flush_location        : 0/4005148
        receiver_replay_location       : 0/4005148
        sync_percent                   : 100%
        sync_state                     : Sync
        sync_priority                  : 1
        sync_most_available            : Off
        channel                        : 10.244.44.52:27001-->10.244.44.52:35912
        
     Receiver info:
    No information 
    ```


